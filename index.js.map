{"version":3,"file":"index.js","sources":["../src/js/pixaby-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46595178-4dac5182a4d6048d037515019';\nconst url = 'https://pixabay.com/api/';\nexport const PER_PAGE = 15;\n\nexport const findPhotos = async (search, page) => {\n  const params = {\n    key: API_KEY,\n    q: search,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n    page: page,\n  };\n\n  try {\n    const response = await axios.get(url, { params });\n    return response.data;\n  } catch (e) {\n    console.log(e); // debug\n    throw new Error(e.response?.data?.message || 'API request failed'); // user error\n  }\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst notFound =\n  'Sorry, there are no images matching your search query. Please try again!';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionSelector: 'img',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\niziToast.settings({\n  position: 'topRight',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nexport const renderGallery = images => {\n  if (images.length == 0) {\n    iziToast.error({\n      message: notFound,\n      position: 'topRight',\n    });\n    return;\n  }\n\n  const gallery = document.querySelector('.gallery');\n\n  const html = images\n    .map(\n      image =>\n        `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${image.webformatURL}\"\n                alt=\"${image.tags}\"\n            />\n        <div class=\"gallery-footer\">\n          <div class=\"footer-item\">\n            <span class=\"item-title\">Likes</span>\n            <span class=\"item-value\">${image.likes}</span>\n          </div>\n          <div class=\"footer-item\">\n            <span class=\"item-title\">Views</span>\n            <span class=\"item-value\">${image.views}</span>\n          </div>\n          <div class=\"footer-item\">\n            <span class=\"item-title\">Comments</span>\n            <span class=\"item-value\">${image.comments}</span>\n          </div>\n          <div class=\"footer-item\">\n            <span class=\"item-title\">Downloads</span>\n            <span class=\"item-value\">${image.downloads}</span>\n          </div>\n        </div>\n        </a>\n    </li>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', html);\n\n  lightbox.refresh();\n};\n\nexport const toast = (message, type) => {\n  if (type == 'error') {\n    iziToast.error({ message });\n  }\n\n  if (type == 'success') {\n    iziToast.success({ message });\n  }\n};\n\nexport const showLoader = () => (loader.style.display = 'block');\n\nexport const hideLoader = () => (loader.style.display = 'none');\n\nexport const hideLoadMoreBtn = () => {\n  loadMoreBtn.style.display = 'none';\n  toast.success({\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n};\n\nexport const showLoadMoreBtn = () => (loadMoreBtn.style.display = 'block');\n","import iziToast from 'izitoast';\nimport { findPhotos, PER_PAGE } from './js/pixaby-api';\nimport {\n  renderGallery,\n  toast,\n  showLoader,\n  hideLoader,\n  showLoadMoreBtn,\n  hideLoadMoreBtn,\n} from './js/render-functions';\n\nconst USER_ERROR_MESSAGE = 'Something went wrong :(';\nconst form = document.querySelector('form');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet currentQuery = '';\nlet page = 1;\nlet totalPages = 0;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  const query = form.elements.search.value.trim();\n\n  if (!query) {\n    toast(\"Query mustn't be empty\", 'error');\n    return;\n  }\n\n  document.querySelector('.gallery').innerHTML = '';\n  currentQuery = query;\n\n  try {\n    showLoader();\n    const apiResponse = await findPhotos(query, page);\n    totalPages = parseInt(apiResponse.total / PER_PAGE);\n    console.log(apiResponse);\n\n    renderGallery(apiResponse?.hits ?? []);\n\n    page < totalPages ? showLoadMoreBtn() : hideLoadMoreBtn();\n    page++;\n  } catch (e) {\n    console.log(e.message);\n    toast(e.message || USER_ERROR_MESSAGE, 'error');\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async e => {\n  e.preventDefault();\n  showLoader();\n\n  try {\n    const apiResponse = await findPhotos(currentQuery, page);\n\n    renderGallery(apiResponse?.hits ?? []);\n    page < totalPages ? showLoadMoreBtn() : hideLoadMoreBtn();\n    page++;\n  } catch (e) {\n    console.log(e.message);\n    toast(e.message || USER_ERROR_MESSAGE, 'error');\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["API_KEY","url","PER_PAGE","findPhotos","search","page","params","axios","e","_b","_a","notFound","lightbox","SimpleLightbox","loader","loadMoreBtn","iziToast","renderGallery","images","gallery","html","image","toast","message","type","showLoader","hideLoader","hideLoadMoreBtn","showLoadMoreBtn","USER_ERROR_MESSAGE","form","currentQuery","totalPages","query","apiResponse"],"mappings":"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"}